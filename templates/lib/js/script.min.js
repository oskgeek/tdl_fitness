function getExerciseList(){$.get("http://"+host+"/excercise/",function(a){var a=$.parseJSON(a);"OK"==a.status?($.each(a.data,function(a,b){var c=b[1].split("..")[1];$("#external-events").append('<div class="fc-event"><div><img src="http://'+host+c+'"></div>'+b[0]+"</div>")}),initExternalEvents()):"FAILED"==res.status&&errorAlert($("#content"),res.Error)})}function setCookie(a,b){document.cookie=a+"="+b}function getCookie(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1);if(0==e.indexOf(b))return e.substring(b.length,e.length)}return""}function checkCookie(a){var a=getCookie(a);return""!=a?!0:void 0}function initExternalEvents(){$("#external-events .fc-event").each(function(){$(this).data("event",{title:$.trim($(this).text()),stick:!0}),$(this).draggable({zIndex:999,revert:!0,revertDuration:0})})}function init(a,b){var d=moment();d=d.stripTime(),d=d.format(),$("#calendar").fullCalendar({header:{center:"title",left:"",right:""},defaultView:"agendaWeek",editable:!0,droppable:!0,viewRender:function(a,b){},drop:function(a,b,c){},eventClick:function(a,b,c){$("#myModal").modal("show");var d=$(this);$("#save_changes").click(function(){saveChanges(a._id,d)})},eventMouseover:function(a,b,c){"agendaDay"!==c.name&&$(b.target).attr("title",a.title)},eventRender:function(a,b,c){b.attr("data-id",a._id),b.find(".fc-title").append('<div class="fc-desc"><span class="ex-set">3</span> sets, <span class="ex-reps">12</span> reps.</div>')},eventAfterRender:function(a,b,c){if(!$.isEmptyObject(obj)){var d=$(b).attr("data-id");obj[d]&&($('[data-id="'+d+'"]').find(".ex-set").text(obj[d].set),$('[data-id="'+d+'"]').find(".ex-reps").text(obj[d].reps))}},eventDragStop:function(a,b){var c=$("#calendarTrash"),d=c.offset(),e=d.left,f=d.left+c.outerWidth(!0),g=d.top,h=d.top+c.outerHeight(!0);if(b.pageX>=e&&b.pageX<=f&&b.pageY>=g&&b.pageY<=h){var i=confirm("Sure! Want to Delete "+a.title+"?");i===!0&&$("#calendar").fullCalendar("removeEvents",a._id)}}});var e="AD"==a?"":" hidden ";$("div.fc-right").append('<div id="calendarTrash" class="hidden-print calendar-trash" title="Drop the event here to delete!"><img src="lib/trash.png"></img></div>'),$("div.fc-left").append('<button id="print" type="button" class="hidden-print fc-button fc-state-default fc-corner-left fc-corner-right">Print</button>').append('<button id="addExModal" type="button" data-toggle="modal" data-target="#addExerciseModal" class="'+e+'hidden-print fc-button fc-state-default fc-corner-left fc-corner-right">Add Exercise</button>'),$(".fc-widget-header .fc-sun").append('<div>Routine 1</div><div class="ex-header">Chest & Tricep</div>'),$(".fc-widget-header .fc-mon").append('<div>Routine 2</div><div class="ex-header">Soulder & Legs</div>'),$(".fc-widget-header .fc-tue").append('<div>Routine 3</div><div class="ex-header">Lats & Biceps</div>'),$(".fc-widget-header .fc-wed").append('<div>Routine 4</div><div class="ex-header">Chest & Tricep</div>'),$(".fc-widget-header .fc-thu").append('<div>Routine 5</div><div class="ex-header">Soulder & Legs</div>'),$(".fc-widget-header .fc-fri").append('<div>Routine 6</div><div class="ex-header">Lats & Biceps</div>'),$(".fc-widget-header .fc-sat").append('<div>Routine 7</div><div class="ex-header">As per choice</div>'),$("#print").click(function(){var a=getCookie("user_id"),c={user_id:a,plan_created:b};$.post("http://"+host+"/plan_created/",c,function(a,b,c){console.log("plan created!")}),window.print()})}function saveChanges(a,b){var c=$("#ex_set").val(),d=$("#ex_reps").val();obj.hasOwnProperty(a)||(obj[a]={set:c,reps:d}),b.find(".ex-set").text(c),b.find(".ex-reps").text(d),$("#myModal").modal("hide")}function PrintElem(a){Popup($(a).html())}function Popup(a){var b=window.open("","My Exercise Schedule","height=600,width=600");return b.document.open(),b.document.write("<html><head><title>My Exercise Schedule</title>"),b.document.write("</head><body >"),b.document.write('<link href="lib/fullcalendar.print.css" rel="stylesheet" media="print" />'),b.document.write(a),b.document.write("</body></html>"),b.document.close(),b.focus(),b.print(),b.close(),!0}function errorAlert(a,b){if(0==$(".alert-danger").length){var c="Something went Wrong!";b=b?b:c;var d='<div class="alert alert-danger alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><strong>Oops! </strong>'+b+"</div>";$(a).before(d)}}var obj={};$(function(){if($("#loginbox").removeClass("hidden"),checkCookie("tdl_email")&&checkCookie("tdl_pw")){$("#loginbox, #signupbox").addClass("hidden"),$("#content").removeClass("hidden"),getExerciseList();var a=new Date,b=a.getDate().toString();b=1==b.length?"0"+b:b;var c=(a.getMonth()+1).toString();c=1==c.length?"0"+c:c;var d=a.getFullYear().toString(),e=c+"/"+b+"/"+d,f=getCookie("plan_created").toString(),g=new Date(f),h=new Date(e),i=Math.floor((h-g)/864e5);i>=60&&errorAlert($("#content h3"),"It's been a while you haven't change your Exercise Schedule, We recommend you to change your plan, Thank You!"),init(getCookie("user_type"),e)}$("#btn-signup").click(function(a){var b=$(this);$.ajax({url:"http://"+host+"/signup/",type:"POST",dataType:"json",data:$("#signupform").serialize()}).done(function(a){"OK"==a.status?($("#signupbox").addClass("hidden"),$("#loginbox").removeClass("hidden")):"FAILED"==a.status&&errorAlert(b,a.Error.length?a.Error:"")}).fail(function(){errorAlert($(that),"")})}),$("#btn-login").click(function(a){var b=$(this);$.ajax({url:"http://"+host+"/login/",type:"POST",dataType:"json",data:$("#loginform").serialize()}).done(function(a){if("OK"==a.status){var c=$('#loginform [name="email"]').val(),d=$('#loginform [name="password"]').val();setCookie("tdl_email",c),setCookie("tdl_pw",d),setCookie("user_id",a.user_id),setCookie("user_type",a.user_type),setCookie("plan_created",a.plan_created),window.location.reload()}else"FAILED"==a.status&&errorAlert(b,a.Error.length?a.Error:"")}).fail(function(){errorAlert(b,"")})}),$("#sign_out").click(function(a){document.cookie="tdl_email=; expires=Thu, 01 Jan 1970 00:00:00 UTC",document.cookie="tdl_pw=; expires=Thu, 01 Jan 1970 00:00:00 UTC",document.cookie="user_id=; expires=Thu, 01 Jan 1970 00:00:00 UTC",document.cookie="user_type=; expires=Thu, 01 Jan 1970 00:00:00 UTC",document.cookie="plan_created=; expires=Thu, 01 Jan 1970 00:00:00 UTC",window.location.reload()});var j=document.forms.namedItem("add_ex_form");j.addEventListener("submit",function(a){a.preventDefault();var c=(document.querySelector("div"),new FormData(j)),d=new XMLHttpRequest;d.open("POST","http://"+host+"/excercise/",!0),d.onload=function(a){200==d.status?window.location.reload():console.log("Error"+d.status+" occurred when trying to upload your file.<br />")},d.send(c)},!1);var k=$("#calendar").height();$("#external-events").css("height",k)});